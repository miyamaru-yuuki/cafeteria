<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=yes">
    <title>メニュー選択画面</title>
    <style>
    </style>
    <link rel="stylesheet" type="text/css" href="/css/styles.css">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
    <script type="text/javascript">
        $(function() {
            function showMenu() {
                $.ajax({
                    url: "/api/cafeteria/",
                    type: "GET",
                    async: true,
                    data: null,
                    dataType: "json",
                    success: function (json) {
                        //成功時の処理
                        json.menuData.forEach(function (data) {
                            $("#menu").append('<div><a class="menulink" href="' +data.mid+ '">' +data.mname+ '</a></div>')
                        });
                    },
                    error: function () {
                        alertError()
                    }
                });
            }

            $('#fm1').submit(function(){
                var kid = $('input[name="kid"]').val();
                $('#menu').show();
                $('#fm1').hide();
                showMenu();
                return false;
            });

            $('#fm2').submit(function(){
                if(mid == 1){
                    curry = curry + parseInt($('input[name="kosu"]').val(), 10);
                    $("label#curry").text('カレー:' +curry);
                }else if(mid == 2){
                    ramen = ramen + parseInt($('input[name="kosu"]').val(), 10);
                    $("label#ramen").text('ラーメン:' +ramen);
                }else if(mid == 3){
                    sarada = sarada + parseInt($('input[name="kosu"]').val(), 10);
                    $("label#sarada").text('サラダ:' +sarada);
                }
                return false;
            });

            $(document).on("click",".menulink",function(){
                mid = $(this).attr("href");
                $('#fm2').show();
                return false;
            });

            var mid;
            var curry = 0;
            var ramen = 0;
            var sarada = 0;
            $('#menu').hide();
            $('#fm2').hide();
        })
    </script>
</head>
<body>
<header>
    <h1>メニュー選択画面</h1>
</header>
<nav>
</nav>
<main>
    <form id="fm1">
        <p>会員ID：<input type="number" name="kid"></p>
        <input type="submit" value="ログイン">
    </form>
    <div name="menu" id="menu">
    </div>
    <form id="fm2">
        <p>個数：<input type="number" name="kosu"></p>
        <input type="submit" value="確定">
    </form>
    <label name="curry" id="curry"></label>
    <label name="ramen" id="ramen"></label>
    <label name="sarada" id="sarada"></label>
</main>
<footer>
</footer>
</div>
</body>
</html>
